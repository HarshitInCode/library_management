<app-header></app-header>
<div class="body-content flex flex-column">
  <main class="flex flex-column gap-3 grow">
    <section class="flex gap-2 items-center justify-between">
      <h3 id="title" class="leading-none">All Users</h3>

      <div class="flex gap-1 items-center">
        <button class="button icon link">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 256 256">
            <path
              d="M32,80a8,8,0,0,1,8-8H72a8,8,0,0,1,0,16H40A8,8,0,0,1,32,80Zm184,88H176V152a8,8,0,0,0-16,0v48a8,8,0,0,0,16,0V184h40a8,8,0,0,0,0-16Zm-80,0H40a8,8,0,0,0,0,16h96a8,8,0,0,0,0-16Zm-32-56a8,8,0,0,0,8-8V88H216a8,8,0,0,0,0-16H112V56a8,8,0,0,0-16,0v48A8,8,0,0,0,104,112Z"
            ></path>
          </svg>
        </button>
      </div>
    </section>

    <section class="flex flex-column gap-2">
      <table>
        <tr class="no-hover">
          <th><span>ID</span></th>
          <th><span>Full Name</span></th>
          <th><span>email</span></th>
          <th><span>Phone Number</span></th>
          <th><span>Role</span></th>
          <th><span>City</span></th>
          <th><span>state</span></th>
          <th><span>Password</span></th>
          <th><span>Action</span></th>
        </tr>

        <tr *ngFor="let item of tableData; let i = index">
          <td>{{ (currentPage - 1) * itemsPerPage + i + 1 }}</td>
          <td>{{ item.fName }}</td>
          <td>{{ item.email }}</td>
          <td>{{ item.phone ? item.phone : "-" }}</td>
          <td>{{ item.role ? item.role : "-" }}</td>
          <td>{{ item.city ? item.city : "-" }}</td>
          <td>{{ item.state ? item.state : "-" }}</td>
          <td>********</td>
          <td>
            <a (click)="deleteUser(item._id)">
              <i class="fa-solid fa-trash"></i>
            </a>
            &nbsp;
            <a (click)="editUser(item._id)" data-bs-toggle="modal" data-bs-target="#exampleModal" data-bs-whatever="@mdo">
              <i class="fa-solid fa-pen-to-square"></i>
            </a>
          </td>
        </tr>
      </table>
      <section class="flex items-center justify-between">
        <small class="muted">{{ currentItemsRange }}</small>

        <div class="flex gap-2 items-center">
          <div class="flex gap-05 items-center">
            <input class="input number small" readonly type="number" [value]="currentPage || 1" />
            <small class="muted">/</small>
            <small class="muted">{{ totalPages || 1 }} pages</small>
          </div>

          <div class="flex gap-05 items-center">
            <button class="button icon link" (click)="previousPage()">
              <i class="fa-solid fa-angle-left"></i>
            </button>

            <button class="button icon link" (click)="nextPage()">
              <i class="fa-solid fa-chevron-right"></i>
            </button>
          </div>
        </div>
      </section>
    </section>
  </main>
</div>
<!-- your.component.html -->
<!-- Update User Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="exampleModalLabel">Update User</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close">
          <i class="fa-solid fa-xmark"></i>
        </button>
      </div>
      <div class="modal-body">
        <form *ngIf="UserForm" [formGroup]="UserForm">
          <!-- Full Name -->
          <div class="mb-3">
            <label for="fName" class="form-label">Full Name</label>
            <input type="text" class="form-control" id="fName" formControlName="fName" [ngClass]="{
                            'is-invalid':
                              UserForm.get('fName')?.invalid &&
                              (UserForm.get('fName')?.touched || isFormTouched)
              }"
              (blur)="onFormControlTouched()"
            />
            <div
              *ngIf="
                UserForm.get('fName')?.hasError('required') &&
                (UserForm.get('fName')?.touched || isFormTouched)
              "
              class="text-danger"
            >
              Full Name is required
            </div>
          </div>

          <!-- Email -->
          <div class="mb-3">
            <label for="email" class="form-label">Email</label>
            <input type="text" class="form-control" id="email" formControlName="email" [ngClass]="{
                            'is-invalid':
                              UserForm.get('email')?.invalid &&
                              (UserForm.get('email')?.touched || isFormTouched)
              }"
              (blur)="onFormControlTouched()"
            />
            <div
              *ngIf="
                UserForm.get('email')?.hasError('required') &&
                (UserForm.get('email')?.touched || isFormTouched)
              "
              class="text-danger"
            >
              Email is required
            </div>
          </div>

          <!-- Password -->
          <div class="mb-3">
            <label for="password" class="form-label">Password</label>
            <input type="password" class="form-control" id="password" formControlName="password" />
            
            <div *ngIf="
                            UserForm.get('password')?.invalid &&
                            (UserForm.get('password')?.touched || isFormTouched)
              "
              class="text-danger"
            >
              Password must be at least 6 characters long
            </div>
          </div>

          <!-- Role -->
          <div class="mb-3">
            <label for="role" class="form-label">Role</label>
            <select class="form-select" id="role" formControlName="role" [ngClass]="{
                            'is-invalid':
                              UserForm.get('role')?.invalid &&
                              (UserForm.get('role')?.touched || isFormTouched)
              }"
              (blur)="onFormControlTouched()"
            >
              <option value="user">User</option>
              <option value="admin">Admin</option>
            </select>
            <div *ngIf="
                            UserForm.get('role')?.hasError('required') &&
                            (UserForm.get('role')?.touched || isFormTouched)
              "
              class="text-danger"
            >
              Role is required
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
          Close
        </button>
        <button type="button" class="btn btn-primary" (click)="saveUser()" [disabled]="!checkFormValidity()"
          data-bs-dismiss="modal">
          Save User
        </button>
      </div>
    </div>
  </div>
</div>
